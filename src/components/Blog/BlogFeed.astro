---
import CardBlog from "./CardBlog.astro";
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";
import { FaArrowRight } from "react-icons/fa";

const blogEntries = await getCollection("blog", ({ id }) => {
  return id;
});

const blogPosts: CollectionEntry<"blog">[] = blogEntries.sort(
  (a: CollectionEntry<"blog">, b: CollectionEntry<"blog">) =>
    b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

// Get the top 3 posts
const mostRecentPost: CollectionEntry<"blog"> = blogPosts[0];
const sidePosts: CollectionEntry<"blog">[] = blogPosts.slice(1, 3);

const data = {
  eyebrow: "Intel & Insights",
  title: "From the Flight Deck",
  subTitle:
    "Mission-focused insights, training tips from the cadre, and industry news for future professional pilots.",
};
---

<section class="py-20 bg-sky-950">
  <div class="max-w-7xl mx-auto px-5 md:px-8 lg:px-12">
    <div class="text-center max-w-3xl mx-auto mb-16">
      <div class="flex items-center justify-center gap-3 mb-1">
        <span class="text-sky-600 font-bold uppercase tracking-widest text-sm">
          {data.eyebrow}
        </span>
      </div>

      <h2
        class="title !text-[2.5rem] uppercase !font-main-header tracking-wide !text-slate-50 mb-6"
      >
        {data.title}
      </h2>

      <p class="text-lg text-slate-400">
        {data.subTitle}
      </p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 mb-16">
      <div class="lg:col-span-7 flex">
        {mostRecentPost && <CardBlog blogEntry={mostRecentPost} index={0} />}
      </div>

      <div class="lg:col-span-5 flex flex-col gap-6">
        {
          sidePosts.map((blogEntry, i) => (
            <div class="flex-1 flex">
              <CardBlog blogEntry={blogEntry} smallCard={true} index={i + 1} />
            </div>
          ))
        }
      </div>
    </div>

    <div class="text-center">
      <a class="btn-primary">
        Read All Articles
        <FaArrowRight />
      </a>
    </div>
  </div>
</section>
