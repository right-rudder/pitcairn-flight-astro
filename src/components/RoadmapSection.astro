---
import {
  FaPlaneDeparture,
  FaHandshake,
  FaGraduationCap,
  FaRoute,
} from "react-icons/fa";

interface Props {
  data: {
    eyebrow: string;
    headline: string;
    cards: {
      title: string;
      text: string;
      icon: string;
      href?: string;
    }[];
  };
}

const { data } = Astro.props;

const getIcon = (iconName: string) => {
  switch (iconName) {
    case "flight":
      return FaPlaneDeparture;
    case "instructor":
      return FaHandshake;
    case "train":
      return FaRoute;
    case "wings":
      return FaGraduationCap;
    default:
      return FaPlaneDeparture;
  }
};
---

<section class="py-6 md:pt-24 bg-white overflow-hidden">
  <div class="max-w-7xl mx-auto px-5 md:px-8 lg:px-12 text-center">
    <p class="text-sky-700 font-bold uppercase tracking-widest text-sm mb-1">
      {data.eyebrow}
    </p>
    <h2
      class="title !text-[2.5rem] uppercase !font-main-header tracking-wide mb-24 mx-auto max-w-3xl"
      set:html={data.headline}
    />

    <div
      class="grid grid-cols-1 mt-20 md:grid-cols-2 lg:grid-cols-4 gap-8"
      id="stagger-container"
    >
      {
        data.cards.map((card, index) => {
          const Icon = getIcon(card.icon);
          return (
            <a
              class="stagger-card opacity-0 translate-y-10 flex flex-col items-center group border-[2px] border-t-5 border-t-sky-600 border-gray-200 hover:border-sky-600 hover:-translate-y-1 transition-all duration-700 px-4 py-10 rounded-2xl shadow-sm hover:shadow-lg"
              style={`transition-delay: ${index * 150}ms;`}
              href={`${card.href ? card.href : "#"}`}
              target={`${card.href?.includes("http") ? "_blank" : "_self"}`}
            >
              <div class="w-16 h-16 rounded-2xl  bg-sky-50 flex items-center justify-center text-sky-700 text-2xl mb-6 group-hover:bg-sky-600 group-hover:text-white transition-colors duration-300">
                <Icon />
              </div>
              {/* <div class="w-8 h-8 rounded-2xl  bg-slate-100 text-slate-500 font-bold flex items-center justify-center text-sm mb-4">
                {index + 1}
              </div> */}
              <div class="flex flex-col items-center justify-center w-full h-full">
                <h3 class="text-xl font-bold text-sky-800 uppercase mb-3">
                  {card.title}
                </h3>
                <p class="text-slate-600 leading-relaxed text-sm items-end">
                  {card.text}
                </p>
              </div>
            </a>
          );
        })
      }
    </div>
  </div>
</section>

<script>
  const observerOptions = {
    threshold: 0.1,
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        const cards = entry.target.querySelectorAll(".stagger-card");
        cards.forEach((card) => {
          card.classList.remove("opacity-0", "translate-y-10");
          card.classList.add("opacity-100", "translate-y-0");
        });
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  const container = document.querySelector("#stagger-container");
  if (container) observer.observe(container);
</script>
