---
import ImageWithGradientAndText from "./ImageWithGradientAndText.astro";

interface Props {
  data: {
    eyebrow: string;
    headline: string;
    bodyCopy: string;
    cta: {
      text: string;
      subtext: string;
    };
    image: {
      src: string;
      alt: string;
    };
  };
}

const { data } = Astro.props;
---

<section class="relative py-42 bg-sky-950 overflow-hidden">
  <div class="absolute inset-0 z-0">
    <ImageWithGradientAndText
      src={data.image.src}
      alt={data.image.alt}
      class="w-full h-full object-cover object-[50%_30%] opacity-40 mix-blend-overlay"
    />
    <div
      class="absolute inset-0 bg-gradient-to-t from-slate-950 to-transparent"
    >
    </div>
  </div>

  <div
    class="reveal-content max-w-4xl mx-auto px-5 md:px-8 lg:px-12 relative z-10 text-center opacity-0 translate-y-8 transition-all duration-1000 ease-out"
  >
    <p class="text-sky-400 font-bold uppercase tracking-widest text-sm mb-1">
      {data.eyebrow}
    </p>
    <h2
      class="title !text-[2.5rem] uppercase !font-main-header tracking-wide !text-slate-50 mb-6"
      set:html={data.headline}
    />
    <p
      class="font-sans font-medium text-slate-50 mb-10 text-xl font-light"
      set:html={data.bodyCopy}
    />

    <div class="flex flex-col items-center gap-4">
      <button class="btn-primary text-lg px-8 py-3 w-full sm:w-auto">
        {data.cta.text}
      </button>
      <p class="text-slate-300 text-sm font-semibold tracking-wide">
        {data.cta.subtext}
      </p>
    </div>
  </div>
</section>

<script>
  const observerOptions = {
    threshold: 0.1,
    rootMargin: "0px 0px -50px 0px",
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.remove("opacity-0", "translate-y-8");
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  document
    .querySelectorAll(".reveal-content")
    .forEach((el) => observer.observe(el));
</script>
